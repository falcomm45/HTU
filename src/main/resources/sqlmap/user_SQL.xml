<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.mapper.UserMapper">
	
	<resultMap type="userVO" id="userMap">
		<result property="userCd" column="USER_CD"/>
		<result property="userNm" column="USER_NM"/>
		<result property="userNme" column="USER_NME"/>
		<result property="userTel" column="USER_TEL"/>
		<result property="userZip" column="USER_ZIP"/>
		<result property="userAddr1" column="USER_ADDR1"/>
		<result property="userAddr2" column="USER_ADDR2"/>
		<result property="userReg1" column="USER_REG1"/>
		<result property="userReg2" column="USER_REG2"/>
		<result property="userMail" column="USER_MAIL"/>
		<result property="userPass" column="USER_PASS"/>
		<result property="userBank" column="USER_BANK"/>
		<result property="userDepo" column="USER_DEPO"/>
		<result property="userAcc" column="USER_ACC"/>
		<result property="fileCd" column="FILE_CD"/>
		<result property="comdCd" column="COMD_CD"/>
		<association property="commonDetailVO" resultMap="cdMap"/>
		<association property="studentVO" resultMap="studentMap"/>
		<association property="professorVO" resultMap="proMap"/>
		<association property="employeeVO" resultMap="empMap"/>
		<association property="filesDetailVO" resultMap="filesMap"/>
	</resultMap>
	
	<resultMap type="filesDetailVO" id="filesMap">
		<result property="fileSn" column="FILE_SN"/>
		<result property="fileCd" column="FILE_CD"/>
		<result property="filePath" column="FILE_PATH"/>
		<result property="fileOrnm" column="FILE_ORNM"/>
		<result property="fileSvnm" column="FILE_SVNM"/>
		<result property="fileExtsn" column="FILE_EXTSN"/>
		<result property="fileCon" column="FILE_CON"/>
		<result property="fileSize" column="FILE_SIZE"/>
	</resultMap>
	
	<resultMap type="employeeVO" id="empMap">
		<result property="empCd" column="EMP_CD"/>
		<result property="empDept" column="EMP_DEPT"/>
		<result property="empPos" column="EMP_POS"/>
		<result property="empJoin" column="EMP_JOIN"/>
		<result property="empQuit" column="EMP_QUIT"/>
	</resultMap>
	
	<resultMap type="commonDetailVO" id="cdMap">
		<result property="comdCd" column="COMD_CD"/>
		<result property="comCd" column="COM_CD"/>
		<result property="comdNm" column="COMD_NM"/>
		<result property="comdDesc" column="COMD_DESC"/>
		<association property="commonVO" resultMap="commonMap"/>
	</resultMap>
	
	<resultMap type="commonVO" id="commonMap">
		<result property="comCd" column="COM_CD"/>
		<result property="comNm" column="COM_NM"/>
		<result property="comDesc" column="COM_DESC"/>
	</resultMap>
	
	<resultMap type="studentVO" id="studentMap">
		<result property="stuCd" column="STU_CD"/>
		<result property="depCd" column="DEP_CD"/>
		<result property="comdCd" column="COMD_CD"/>
		<result property="stuYear" column="STU_YEAR"/>
		<result property="stuSem" column="STU_SEM"/>
		<result property="stuMrc" column="STU_MRC"/>
		<result property="stuMoc" column="STU_MOC"/>
		<result property="stuCrc" column="STU_CRC"/>
		<result property="stuCoc" column="STU_COC"/>
		<result property="stuAddt" column="STU_ADDT"/>
		<result property="stuGrdt" column="STU_GRDT"/>
		<association property="departmentVO" resultMap="departmentMap"/>
		<collection property="wishLectureList" resultMap="wishLectureMap"/>
	</resultMap>
	
	<resultMap type="wishLectureVO" id="wishLectureMap">
		<result property="stuCd" column="LEC_STU_CD"/>
		<result property="lecCd" column="LEC_CD"/>
	</resultMap>
	
	<resultMap type="departmentVO" id="departmentMap">
		<result property="depCd" column="DEP_CD"/>
		<result property="colCd" column="COL_CD"/>
		<result property="depNm" column="DEP_NM"/>
		<result property="depMrc" column="DEP_MRC"/>
		<result property="depMoc" column="DEP_MOC"/>
		<result property="depCrc" column="DEP_CRC"/>
		<result property="depCoc" column="DEP_COC"/>
		<result property="depCap" column="DEP_CAP"/>
		<result property="depTel" column="DEP_TEL"/>
		<result property="depFee" column="DEP_FEE"/>
		<association property="collegeVO" resultMap="collegeMap" />
	</resultMap>
	
	<resultMap type="professorVO" id="proMap">
		<result property="proCd" column="PRO_CD"/>
		<result property="depCd" column="DEP_CD"/>
		<result property="roomCd" column="ROOM_CD"/>
		<result property="proJoin" column="PRO_JOIN"/>
		<result property="proRet" column="PRO_RET"/>
		<result property="proPos" column="PRO_POS"/>
		<association property="departmentVO" resultMap="departmentMap"/>
	</resultMap>
	
	<resultMap type="collegeVO" id="collegeMap">
		<result property="colCd" column="COL_CD"/>
		<result property="colCrd" column="COL_CRD"/>
	</resultMap>
	
	<select id="getAuthority" parameterType="String" resultType="String">
		SELECT COMD_CD FROM USERS WHERE USER_CD = #{userCd}
	</select>
	
	
	<select id="getStudentInfo" resultMap="userMap" parameterType="String">
		SELECT 	USER_CD, USER_NM, USER_NME, USER_TEL, USER_ZIP, USER_ADDR1, USER_ADDR2, 
		        USER_REG1, USER_REG2, USER_MAIL, USER_PASS, USER_BANK, USER_DEPO, USER_ACC, 
		        U.FILE_CD, U.COMD_CD, CD.COM_CD, COMD_NM, COMD_DESC, COM_NM, COM_DESC,
		        S.STU_CD, S.DEP_CD, S.COMD_CD, STU_YEAR, STU_SEM, STU_MRC, STU_MOC, STU_CRC, STU_COC, STU_ADDT, STU_GRDT,
		        D.DEP_CD, D.COL_CD, DEP_NM, DEP_MRC, DEP_MOC, DEP_CRC, DEP_COC, DEP_CAP, DEP_TEL, DEP_FEE,
		        CO.COL_CD, COL_CRD,
		        FILE_SN, F.FILE_CD, FILE_ORNM, FILE_SVNM, FILE_EXTSN, FILE_CON, FILE_SIZE, FILE_USED,
		        WL.STU_CD AS LEC_STU_CD, WL.LEC_CD
		FROM 	USERS U, COMMON_DETAIL CD, COMMON C, STUDENT S, DEPARTMENT D, COLLEGE CO, WISH_LECTURE WL, FILES_DETAIL F
		WHERE 	U.COMD_CD = CD.COMD_CD
		AND 	CD.COM_CD = C.COM_CD
		AND     U.USER_CD = S.STU_CD
		AND     S.DEP_CD = D.DEP_CD
		AND		CO.COL_CD = D.COL_CD
		AND     U.USER_CD = WL.STU_CD(+)
		AND     F.FILE_CD(+) = U.USER_CD
		AND		U.USER_CD = #{userCd}
	</select>
	
	<select id="getProfessorInfo" resultMap="userMap" parameterType="String">
		SELECT 	USER_CD, USER_NM, USER_NME, USER_TEL, USER_ZIP, USER_ADDR1, USER_ADDR2, 
		        USER_REG1, USER_REG2, USER_MAIL, USER_PASS, USER_BANK, USER_DEPO, USER_ACC, 
		        U.FILE_CD, U.COMD_CD, CD.COM_CD, COMD_NM, COMD_DESC, COM_NM, COM_DESC,
		        PRO_CD, P.DEP_CD, ROOM_CD, PRO_JOIN, PRO_RET, PRO_POS,
		        D.DEP_CD, COL_CD, DEP_NM, DEP_MRC, DEP_MOC, DEP_CRC, DEP_COC, DEP_CAP, DEP_TEL, DEP_FEE,
		        FILE_SN, F.FILE_CD, FILE_ORNM, FILE_SVNM, FILE_EXTSN, FILE_CON, FILE_SIZE, FILE_USED
		FROM    USERS U, COMMON_DETAIL CD, COMMON C, PROFESSOR P, DEPARTMENT D, FILES_DETAIL F
		WHERE   U.COMD_CD = CD.COMD_CD
		AND     CD.COM_CD = C.COM_CD
		AND     U.USER_CD = P.PRO_CD
		AND     P.DEP_CD = D.DEP_CD
		AND		U.USER_CD = F.FILE_CD(+) 
		AND		U.USER_CD = #{userCd}
	</select>
	
	<select id="getEmployeeInfo" resultMap="userMap" parameterType="String">
		SELECT 	USER_CD, USER_NM, USER_NME, USER_TEL, USER_ZIP, USER_ADDR1, USER_ADDR2, 
		        USER_REG1, USER_REG2, USER_MAIL, USER_PASS, USER_BANK, USER_DEPO, USER_ACC, 
		        FILE_CD, U.COMD_CD, CD.COM_CD, COMD_NM, COMD_DESC, COM_NM, COM_DESC,
		        EMP_CD, EMP_DEPT, EMP_POS, EMP_JOIN, EMP_QUIT
		FROM    USERS U, COMMON_DETAIL CD, COMMON C, EMPLOYEE E
		WHERE   U.COMD_CD = CD.COMD_CD
		AND     CD.COM_CD = C.COM_CD
		AND     U.USER_CD = E.EMP_CD
		AND		U.USER_CD = #{userCd}
	</select>
	
	
	<select id="userList" resultType="userVO">
		SELECT USER_CD, FILE_CD, USER_NM, USER_NME, USER_TEL, USER_ZIP, USER_ADDR1, USER_ADDR2, USER_REG1, USER_REG2, USER_MAIL, USER_PASS, USER_BANK, USER_DEPO, USER_ACC, COMD_CD
		FROM USERS
	</select>
	
	<select id="getUserNameByUserCd" parameterType="String" resultType="String">
		SELECT USER_NM FROM USERS WHERE USER_CD = #{userCd}
	</select>
	
	<select id="getStudentList" resultMap="userMap">
		SELECT 	STU_CD, S.COMD_CD, USER_NM, USER_CD
		FROM 	STUDENT S, USERS U 
		WHERE 	S.STU_CD = U.USER_CD
		AND		S.COMD_CD = 'RECD01'
	</select>
	
	<select id="getProfessorList" resultMap="userMap">
		SELECT 	USER_CD, USER_NM
		FROM 	PROFESSOR P, USERS U
		WHERE	P.PRO_CD = U.USER_CD
	</select>
	
</mapper>